Running all proteins sequentially
Job ID: 3820464
Config: fgr_proteingym_config.yaml
2026-02-02 17:26:59,323 [INFO] ============================================================
2026-02-02 17:26:59,323 [INFO] FGR ProteinGym Fitness Prediction Analysis
2026-02-02 17:26:59,323 [INFO] ============================================================
2026-02-02 17:26:59,323 [INFO] Config: fgr_proteingym_config.yaml
2026-02-02 17:26:59,323 [INFO] Output: /scratch/project/open-35-8/pimenol1/ProteinTTT_merge/ProteinTTT/results/fgr_proteingym
2026-02-02 17:26:59,330 [INFO] Loaded 217 proteins from reference file
2026-02-02 17:26:59,332 [INFO] Selected 1 proteins (max length: 400)
2026-02-02 17:26:59,332 [INFO]   - HIS7_YEAST_Pokusaeva_2019: length=220, mutations=496137
2026-02-02 17:26:59,332 [INFO] 
============================================================
2026-02-02 17:26:59,332 [INFO] Protein 1/1
2026-02-02 17:26:59,332 [INFO] ============================================================
2026-02-02 17:26:59,332 [INFO] Processing HIS7_YEAST_Pokusaeva_2019 (length: 220)
2026-02-02 17:27:00,859 [INFO] Using 'DMS_score' as fitness column, 'mutant' as mutation column, 168 mutations
2026-02-02 17:27:00,859 [INFO] Using device: cuda
2026-02-02 17:27:00,859 [INFO] Loading model: esm2_t33_650M_UR50D
2026-02-02 17:27:10,551 [INFO] Running ProteinTTT for 30 steps...
2026-02-02 17:27:27,114 | INFO | step: 0, accumulated_step: 0, loss: None, perplexity: 3.10084, ttt_step_time: 0.00000, score_seq_time: 8.64662, eval_step_time: 7.86957, lr: 0.00004, fgr_ratio: None, fgr_loss_delta: None, fgr_drift_delta: None, fgr_ratio_cumulative: None, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: None, fgr_ema_ratio: None, spearman: 0.02837, fitness_eval_time: 7.77725
2026-02-02 17:27:44,026 | INFO | step: 1, accumulated_step: 4, loss: 0.31040, perplexity: 3.09944, ttt_step_time: 1.29766, score_seq_time: 7.78053, eval_step_time: 7.81535, lr: 0.00004, fgr_ratio: -11710.00000, fgr_loss_delta: -0.00140, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: 0.00000, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: 0.00000, fgr_ema_ratio: 0.00000, spearman: 0.02804, fitness_eval_time: 7.77486
2026-02-02 17:28:00,924 | INFO | step: 2, accumulated_step: 8, loss: 0.32121, perplexity: 3.09789, ttt_step_time: 1.29273, score_seq_time: 7.78019, eval_step_time: 7.80534, lr: 0.00004, fgr_ratio: -26116.00000, fgr_loss_delta: -0.00156, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -8705.33333, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.00156, fgr_ema_ratio: 4352.66667, spearman: 0.02804, fitness_eval_time: 7.76922
2026-02-02 17:28:17,818 | INFO | step: 3, accumulated_step: 12, loss: 0.29594, perplexity: 3.09638, ttt_step_time: 1.29266, score_seq_time: 7.78129, eval_step_time: 7.80131, lr: 0.00004, fgr_ratio: -25248.00000, fgr_loss_delta: -0.00150, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -25682.00000, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.00306, fgr_ema_ratio: 16105.50000, spearman: 0.02804, fitness_eval_time: 7.76519
2026-02-02 17:28:34,718 | INFO | step: 4, accumulated_step: 16, loss: 0.31587, perplexity: 3.09490, ttt_step_time: 1.29242, score_seq_time: 7.77804, eval_step_time: 7.80997, lr: 0.00004, fgr_ratio: None, fgr_loss_delta: -0.00148, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -38104.00000, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.00454, fgr_ema_ratio: 27104.75000, spearman: 0.02821, fitness_eval_time: 7.77386
2026-02-02 17:28:51,639 | INFO | step: 5, accumulated_step: 20, loss: 0.32005, perplexity: 3.09342, ttt_step_time: 1.29286, score_seq_time: 7.79035, eval_step_time: 7.81924, lr: 0.00004, fgr_ratio: -6207.00000, fgr_loss_delta: -0.00148, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -16839.33333, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.00602, fgr_ema_ratio: 12937.12500, spearman: 0.02821, fitness_eval_time: 7.78305
2026-02-02 17:29:08,560 | INFO | step: 6, accumulated_step: 24, loss: 0.35786, perplexity: 3.09194, ttt_step_time: 1.29285, score_seq_time: 7.79147, eval_step_time: 7.81811, lr: 0.00004, fgr_ratio: -8314.66667, fgr_loss_delta: -0.00149, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -41993.33333, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.00751, fgr_ema_ratio: 33933.79167, spearman: 0.02780, fitness_eval_time: 7.78199
2026-02-02 17:29:25,467 | INFO | step: 7, accumulated_step: 28, loss: 0.30987, perplexity: 3.09050, ttt_step_time: 1.29426, score_seq_time: 7.78847, eval_step_time: 7.80499, lr: 0.00004, fgr_ratio: -8010.66667, fgr_loss_delta: -0.00143, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -25002.00000, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.00894, fgr_ema_ratio: 20984.44792, spearman: 0.02808, fitness_eval_time: 7.76887
2026-02-02 17:29:42,374 | INFO | step: 8, accumulated_step: 32, loss: 0.32246, perplexity: 3.08899, ttt_step_time: 1.29310, score_seq_time: 7.78807, eval_step_time: 7.80760, lr: 0.00004, fgr_ratio: -12702.00000, fgr_loss_delta: -0.00151, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -21927.00000, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.01046, fgr_ema_ratio: 18832.66797, spearman: 0.02825, fitness_eval_time: 7.77138
2026-02-02 17:29:59,293 | INFO | step: 9, accumulated_step: 36, loss: 0.30986, perplexity: 3.08762, ttt_step_time: 1.29330, score_seq_time: 7.79014, eval_step_time: 7.81677, lr: 0.00004, fgr_ratio: -5760.00000, fgr_loss_delta: -0.00137, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -16538.00000, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.01183, fgr_ema_ratio: 14546.55599, spearman: 0.02855, fitness_eval_time: 7.78061
2026-02-02 17:30:16,212 | INFO | step: 10, accumulated_step: 40, loss: 0.31401, perplexity: 3.08622, ttt_step_time: 1.29451, score_seq_time: 7.79233, eval_step_time: 7.81315, lr: 0.00004, fgr_ratio: None, fgr_loss_delta: -0.00140, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -18491.00000, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.01323, fgr_ema_ratio: 16518.77799, spearman: 0.02855, fitness_eval_time: 7.77693
2026-02-02 17:30:33,130 | INFO | step: 11, accumulated_step: 44, loss: 0.29788, perplexity: 3.08482, ttt_step_time: 1.29327, score_seq_time: 7.78704, eval_step_time: 7.81875, lr: 0.00004, fgr_ratio: -23540.00000, fgr_loss_delta: -0.00140, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -18879.38462, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.01463, fgr_ema_ratio: 17063.74369, spearman: 0.02838, fitness_eval_time: 7.78259
2026-02-02 17:30:50,051 | INFO | step: 12, accumulated_step: 48, loss: 0.32072, perplexity: 3.08340, ttt_step_time: 1.29334, score_seq_time: 7.79330, eval_step_time: 7.81609, lr: 0.00004, fgr_ratio: -7910.66667, fgr_loss_delta: -0.00141, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -16822.75000, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.01604, fgr_ema_ratio: 15343.52087, spearman: 0.02841, fitness_eval_time: 7.77997
2026-02-02 17:31:06,978 | INFO | step: 13, accumulated_step: 52, loss: 0.30947, perplexity: 3.08200, ttt_step_time: 1.29318, score_seq_time: 7.79405, eval_step_time: 7.82122, lr: 0.00004, fgr_ratio: -11784.00000, fgr_loss_delta: -0.00140, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -16262.88889, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.01745, fgr_ema_ratio: 14950.78706, spearman: 0.02841, fitness_eval_time: 7.78499
2026-02-02 17:31:23,894 | INFO | step: 14, accumulated_step: 56, loss: 0.30543, perplexity: 3.08061, ttt_step_time: 1.29349, score_seq_time: 7.79483, eval_step_time: 7.80817, lr: 0.00004, fgr_ratio: -5828.00000, fgr_loss_delta: -0.00139, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -14365.63636, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.01884, fgr_ema_ratio: 13299.04925, spearman: 0.02757, fitness_eval_time: 7.77201
2026-02-02 17:31:40,809 | INFO | step: 15, accumulated_step: 60, loss: 0.32555, perplexity: 3.07903, ttt_step_time: 1.29301, score_seq_time: 7.78238, eval_step_time: 7.82103, lr: 0.00004, fgr_ratio: -6610.00000, fgr_loss_delta: -0.00158, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -13172.46154, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.02041, fgr_ema_ratio: 12212.75161, spearman: 0.02729, fitness_eval_time: 7.78490
2026-02-02 17:31:57,723 | INFO | step: 16, accumulated_step: 64, loss: 0.30171, perplexity: 3.07765, ttt_step_time: 1.29339, score_seq_time: 7.79369, eval_step_time: 7.80878, lr: 0.00004, fgr_ratio: -11564.00000, fgr_loss_delta: -0.00138, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -15233.83333, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.02179, fgr_ema_ratio: 14232.15712, spearman: 0.02704, fitness_eval_time: 7.77257
2026-02-02 17:32:14,644 | INFO | step: 17, accumulated_step: 68, loss: 0.29954, perplexity: 3.07620, ttt_step_time: 1.29353, score_seq_time: 7.79015, eval_step_time: 7.81871, lr: 0.00004, fgr_ratio: -3487.42857, fgr_loss_delta: -0.00146, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -12581.41935, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.02325, fgr_ema_ratio: 11799.93179, spearman: 0.02687, fitness_eval_time: 7.78245
2026-02-02 17:32:31,577 | INFO | step: 18, accumulated_step: 72, loss: 0.33436, perplexity: 3.07486, ttt_step_time: 1.29569, score_seq_time: 7.79745, eval_step_time: 7.82136, lr: 0.00004, fgr_ratio: -5630.00000, fgr_loss_delta: -0.00134, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -11786.97143, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.02459, fgr_ema_ratio: 11119.16979, spearman: 0.02679, fitness_eval_time: 7.78512
2026-02-02 17:32:48,511 | INFO | step: 19, accumulated_step: 76, loss: 0.29846, perplexity: 3.07350, ttt_step_time: 1.29585, score_seq_time: 7.79739, eval_step_time: 7.82147, lr: 0.00004, fgr_ratio: -22724.00000, fgr_loss_delta: -0.00135, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -12090.77778, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.02594, fgr_ema_ratio: 11450.54087, spearman: 0.02692, fitness_eval_time: 7.78523
2026-02-02 17:33:05,443 | INFO | step: 20, accumulated_step: 80, loss: 0.31353, perplexity: 3.07211, ttt_step_time: 1.29474, score_seq_time: 7.79735, eval_step_time: 7.82109, lr: 0.00004, fgr_ratio: -3883.33333, fgr_loss_delta: -0.00139, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -10918.28571, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.02733, fgr_ema_ratio: 10366.51752, spearman: 0.02697, fitness_eval_time: 7.78486
2026-02-02 17:33:22,375 | INFO | step: 21, accumulated_step: 84, loss: 0.29689, perplexity: 3.07075, ttt_step_time: 1.29567, score_seq_time: 7.79740, eval_step_time: 7.82083, lr: 0.00004, fgr_ratio: -3798.00000, fgr_loss_delta: -0.00136, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -10028.25000, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.02869, fgr_ema_ratio: 9549.47641, spearman: 0.02674, fitness_eval_time: 7.78462
2026-02-02 17:33:39,305 | INFO | step: 22, accumulated_step: 88, loss: 0.31552, perplexity: 3.06928, ttt_step_time: 1.29362, score_seq_time: 7.79553, eval_step_time: 7.82158, lr: 0.00004, fgr_ratio: -24796.00000, fgr_loss_delta: -0.00148, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -10329.63265, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.03017, fgr_ema_ratio: 9842.11090, spearman: 0.02648, fitness_eval_time: 7.78538
2026-02-02 17:33:56,238 | INFO | step: 23, accumulated_step: 92, loss: 0.33105, perplexity: 3.06783, ttt_step_time: 1.29572, score_seq_time: 7.79745, eval_step_time: 7.82131, lr: 0.00004, fgr_ratio: -4844.00000, fgr_loss_delta: -0.00144, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -9821.70370, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.03161, fgr_ema_ratio: 9376.25402, spearman: 0.02648, fitness_eval_time: 7.78510
2026-02-02 17:34:13,172 | INFO | step: 24, accumulated_step: 96, loss: 0.30412, perplexity: 3.06652, ttt_step_time: 1.29546, score_seq_time: 7.79784, eval_step_time: 7.82199, lr: 0.00004, fgr_ratio: -7345.33333, fgr_loss_delta: -0.00131, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -9691.36842, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.03293, fgr_ema_ratio: 9287.06769, spearman: 0.02655, fitness_eval_time: 7.78577
2026-02-02 17:34:30,102 | INFO | step: 25, accumulated_step: 100, loss: 0.32476, perplexity: 3.06493, ttt_step_time: 1.29370, score_seq_time: 7.79720, eval_step_time: 7.82065, lr: 0.00004, fgr_ratio: -3337.00000, fgr_loss_delta: -0.00159, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -8909.29231, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.03452, fgr_ema_ratio: 8526.66814, spearman: 0.02671, fitness_eval_time: 7.78444
2026-02-02 17:34:47,033 | INFO | step: 26, accumulated_step: 104, loss: 0.29877, perplexity: 3.06354, ttt_step_time: 1.29367, score_seq_time: 7.79717, eval_step_time: 7.82179, lr: 0.00004, fgr_ratio: -3868.00000, fgr_loss_delta: -0.00138, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -8483.26761, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.03590, fgr_ema_ratio: 8144.68612, spearman: 0.02701, fitness_eval_time: 7.78558
2026-02-02 17:35:03,966 | INFO | step: 27, accumulated_step: 108, loss: 0.32566, perplexity: 3.06219, ttt_step_time: 1.29544, score_seq_time: 7.79726, eval_step_time: 7.82071, lr: 0.00004, fgr_ratio: None, fgr_loss_delta: -0.00136, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -8803.88732, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.03726, fgr_ema_ratio: 8474.28672, spearman: 0.02657, fitness_eval_time: 7.78449
2026-02-02 17:35:20,899 | INFO | step: 28, accumulated_step: 112, loss: 0.30695, perplexity: 3.06088, ttt_step_time: 1.29540, score_seq_time: 7.79691, eval_step_time: 7.82192, lr: 0.00004, fgr_ratio: -3650.66667, fgr_loss_delta: -0.00131, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -8402.33766, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.03856, fgr_ema_ratio: 8108.14518, spearman: 0.02607, fitness_eval_time: 7.78570
2026-02-02 17:35:37,820 | INFO | step: 29, accumulated_step: 116, loss: 0.29090, perplexity: 3.05952, ttt_step_time: 1.29359, score_seq_time: 7.79109, eval_step_time: 7.81858, lr: 0.00004, fgr_ratio: -4581.60000, fgr_loss_delta: -0.00137, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -8169.36585, fgr_drift: 0.00000, _fgr_cumulative_loss_gain: -0.03993, fgr_ema_ratio: 7891.55597, spearman: 0.02586, fitness_eval_time: 7.78246
2026-02-02 17:35:54,750 | INFO | step: 30, accumulated_step: 120, loss: 0.30188, perplexity: 3.05821, ttt_step_time: 1.29358, score_seq_time: 7.79541, eval_step_time: 7.82149, lr: 0.00004, fgr_ratio: -2185.20000, fgr_loss_delta: -0.00130, fgr_drift_delta: 0.00000, fgr_ratio_cumulative: -7518.91304, fgr_drift: 0.00001, _fgr_cumulative_loss_gain: -0.04123, fgr_ema_ratio: 7276.34559, spearman: 0.02592, fitness_eval_time: 7.78537
2026-02-02 17:35:54,755 [INFO] TTT completed in 524.20s
2026-02-02 17:35:54,761 [INFO] Saved results to /scratch/project/open-35-8/pimenol1/ProteinTTT_merge/ProteinTTT/results/fgr_proteingym/HIS7_YEAST_Pokusaeva_2019_ttt.csv
2026-02-02 17:35:54,761 [INFO] HIS7_YEAST_Pokusaeva_2019: Initial Spearman=0.0284, Final Spearman=0.0259
2026-02-02 17:35:54,768 [INFO] Saved combined results to /scratch/project/open-35-8/pimenol1/ProteinTTT_merge/ProteinTTT/results/fgr_proteingym/all_proteins_combined.csv
2026-02-02 17:35:54,768 [INFO] 
============================================================
2026-02-02 17:35:54,768 [INFO] Analysis complete!
2026-02-02 17:35:54,768 [INFO] ============================================================
Job completed at Mon Feb  2 17:35:55 CET 2026
